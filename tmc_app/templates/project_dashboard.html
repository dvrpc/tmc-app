{% extends "navbar_logged_in.html" %}

{% block content %}
<div class="container">
    <div class="row">
    <div class="col-sm p-4" style="{{current_user.background}}">
            <h1>{{ current_user.name }}</h1>

            <ul>
                <li>Created {{ current_user.num_projects_created() }} projects</li>
                <li>Uploaded X files to  X projects</li>
            </ul>

        </div>
        <div class="col mt-4">
        <h5>
            Add a Project
        </h5>
          <form method="POST" action="/my-projects/add">
            {{ form.csrf_token }}
  
            <div class="form-group">
              <label for="name">{{ form.name.label }}</label>
              <input type="text" class="form-control" id="name" name="name" >
                {% if form.name.errors %}
                  <ul class="errors">
                    {% for error in form.name.errors %}
                      <li>{{ error }}</li>{% endfor %}
                  </ul>
                {% endif %}
            </div>
            <div class="form-group">
              <label for="description">{{ form.description.label }}</label>
              <input type="text" class="form-control" id="description" name="description" >
                {% if form.description.errors %}
                  <ul class="errors">
                    {% for error in form.description.errors %}
                      <li>{{ error }}</li>{% endfor %}
                  </ul>
                {% endif %}
            </div>
            <center>
              <button type="submit" name="submit" value="login" class="btn btn-primary">Add Project</button>
            </center>
          </form>
        </div>
    </div>

<!-- Flashed messages -->
<div class="row mt-4">
  <div class="col">
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class=flashes>
      {% for category, message in messages %}
        <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
            {{ message }}
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
        </div>
      {% endfor %}
      </div>
    {% endif %}
    {% endwith %}
  </div>
</div>




{% if not your_projects %}
<div class="row">
  <div class="col">
    <h5>Welcome to the TMC Summarizer!</h5>

    <p>
      Create a new project using the form above.
    </p>
    <p>Projects created by others are shown below. You can upload data to and analyze these projects as well.</p>
    <p>
      User profiles and projects get a randomly generated "rainbow" as the default color.
      Some are really nice, some are more mediocre. Feel free to play around with the random generator
      by <a href="/rainbows">clicking here</a>. This page allows you to update the default colors
      for your profile or any project.
    </p>
  
  </div>
</div>

{% else %}
<div class="row">
  <div class="col">
    <h5>Projects created by {{ current_user.name }}</h5>
    <hr>
  </div>
</div>
<div class="row">
  {% for project in your_projects %}
    <div class="col-sm-4">
      <div class="card border-white mb-4" style="height:12rem;  {{ project.background }}"">
        <div class="card-body">
          <h5 class="card-title">{{ project.name }}</h5>
          <p class="card-text">{{ project.description }}</p>
          <a href="#" class="btn btn-light btn-sm">Open</a>
        </div>
      </div>
    </div>
    {% endfor %}

</div>
{% endif %}


{% if not other_projects %}
<div class="row">
  <div class="col">
    <hr>
    <h5>
      Projects created by others will appear here
    </h5>
    <hr>
  </div>
</div>

{% else %}
<div class="row">
  <div class="col">
    <hr>
    <h5>Projects created by others</h5>
    <hr>
  </div>
</div>
<div class="row">
  {% for project in other_projects %}
    <div class="col-sm-4">
      <div class="card border-white mb-4" style="height:12rem;  {{ project.background }}"">
        <div class="card-body">
          <h5 class="card-title">{{ project.name }}</h5>
          <p class="card-text">{{ project.description }}</p>
          <a href="/project/{{project.uid}}" class="btn btn-light btn-sm">Open</a>
        </div>
      </div>
    </div>
    {% endfor %}
</div>
{% endif %}

</div>

{% endblock %}